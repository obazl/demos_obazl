always --incompatible_enable_cc_toolchain_resolution
always --experimental_cc_shared_library
always --enable_bzlmod

try-import .config/coswitch_registry.bazelrc
always --registry=file:///Users/gar/obazl/registry

# always --registry=https://raw.githubusercontent.com/obazl/registry/dev/
# common --registry=https://raw.githubusercontent.com/obazl/registry/main/
always --registry=https://bcr.bazel.build

################
# toolchain selection: vm (bytecode), sys (nativecode) E.g. to compile
# with ocamlc.opt, pass --config=sysvm (sys to vm). this means:
# cross-compile from sys platform (native code) to vm (bytecode).

## IMPORTANT: --host_platform sets buildhost; --platforms sets targethost

# common --announce_rc

# common --toolchain_resolution_debug=".*"

# default platform is sys for both buildhost and targethost

build:vm --platforms=@ocaml//platform:vm

build --host_platform=@ocaml//platform/build:sys
build --platforms=@ocaml//platform/target:sys

# build:vmvm --host_platform=@ocaml//platform:vm
# build:vmvm --platforms=@ocaml//platform:vm
common:ocamlc.byte --host_platform=@ocaml//platform/build:vm
common:ocamlc.byte --platforms=@ocaml//platform/target:vm

build:ocamlc.opt --host_platform=@ocaml//platform/build:sys
build:ocamlc.opt --platforms=@ocaml//platform/target:vm

build:ocamlopt.byte --host_platform=@ocaml//platform/build:vm
build:ocamlopt.byte --platforms=@ocaml//platform/target:sys

build:ocamlopt.opt --host_platform=@ocaml//platform/build:sys
build:ocamlopt.opt --platforms=@ocaml//platform/target:sys

try-import .config/user.bazelrc
